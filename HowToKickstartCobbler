== Introducing Spacewalk and Cobbler ==

Version 0.4 of Spacewalk adds significantly enhanced machine kickstarting capabilities due the the advent of tight integration between Spacewalk and the [https://fedorahosted.org/cobbler/ Cobbler] installation server system.  Cobbler is in fact now a component of Spacewalk - when you install Spacewalk, Cobbler will be included as a dependency.  

With Cobbler integration, Spacewalk gains some exciting new features:

 * Xen installs now use the virtinst library (same as virt manager)
 * Support for qemu/kvm based virtual machines
 * Support for lvm-backed guest installs
 * Support for virtual machines with multiple disks
 * Support for virtual machines with multiple NICs
 * Increased breadth of operating system support:
	* First-class support for
		* RHEL
		* Fedora
		* CentOS
	* Second-class support (ks templates and PXE only) for
		* Debian / Ubuntu
		* SuSE
 * Additional deployment options:
	* Bare-metal PXE kickstarting is supported
		* Auto-generated and updated menus
		* No longer necessary to install an OS in order to kickstart
 	* LiveCD / DeadCD support for bare metal rollouts where PXE isn't possible
	* Bare-metal kickstarts possible on multiple subnets
 * Integrated DHCP and DNS management
 * Powerful kickstart file templating

== Quick Start Guide ==

Here's a quick guide to get you going with the new goodies:

 1. Create a Distro
     a. Some prep work
	1. You're going to need some distribution isos and some loop mounts of them to get the ball rolling here, so...
		a. make a directory /var/iso-images
		a. download a copy of Fedora-9-i386-DVD.iso to that directory
		a. make a directory /var/distro-trees
			* within that directory make a directory Fedora-9
		a. mount -oloop /var/iso-images/Fedora-9-i386-DVD.iso /var/distro-trees/Fedora-9
			* You may find it useful to include an entry in /etc/fstab to ensure this mount persists across reboots
     a. In Spacewalk
	1. Create a channel for the distribution you wish to kickstart (if you have one set up already, go to the next step)
		a. Select Channels|Manage Software Channels and select "+ create new channel"
		a. Fill in the required fields as described - call it "Fedora 9" with a label "fedora-9"
		a. Populate the channel with packages using rhnpush
			* e.g. rhnpush --server localhost -u admin -p spacewalk  --channel fedora-9 /var/distro-trees/Fedora-9/Packages/*.rpm
			* Note that this step takes "a while" - don't be alarmed - just take a *long* lunch. We're working on the speed issue for the next release.
	1. Having made the base channel, you must now create a child channel that contains some kickstart helper tools
		a. Select Channels|Manage Software Channels and select "+ create new channel"
		a. Fill in the required fields as described - call it "Fedora 9 with Tools" and label "fedora-9-with-tools"
		a. Download the following packages from http://spacewalk.redhat.com/yum/0.4:
			* pyOpenSSL
			* rhnlib
			* libxml2-python
			* spacewalk-koan*
		a. Populate your new child channel with these rpms using  "rhnpush --server localhost -u admin -p spacewalk  --channel fedora-9-with-tools /path/to/the/helper/rpms/*.rpm"
		a. You're now ready to create a kickstart distro
	1. Select Systems|Kickstart|Distributions and select "+ create new distribution"
	1. On the "Create Kickstart Distribution" page, fill in the items as described
		a. Distribution label in this case might be Fedora-9
		a. Tree path should be /var/distro-trees/Fedora-9
		a. Base channel should be "Fedora 9 with Tools"
		a. Installer generation should be Fedora 9 in this case.
		a. Once you've pressed the "Create Kickstart Distribution" button you'll see a table that includes your new entry.
		a. If you run "cobbler distro list" at your spacewalk system's command line, you'll now see these entries in addition to any others you may have already defined:
			* Fedora-9:1:Spacewalk-Public-Cert
			* Fedora-9:xen:1:Spacewalk-Public-Cert
     a. In Cobbler
	1. You create distributions in cobbler in the same way you would if cobbler were stand-alone. Note however that if you create distributions this way, they'll not be managed by spacewalk.   Using the iso and mount point we set up above:
		a. cobbler distro add --name "Fedora-9-Cobbler" --kernel /var/distro-trees/Fedora-9/images/pxeboot/vmlinuz  --initrd /var/distro-trees/Fedora-9/images/pxeboot/initrd.img
		a. cobbler distro list now yields:
			* Fedora-9-Cobbler
			* Fedora-9:1:Spacewalk-Public-Cert
			* Fedora-9:xen:1:Spacewalk-Public-Cert
		a. And you'll note that the new distribution does *not* appear in Spacewalk's list of kickstartable distributions.
 1. Having created your kickstartable distribution, you can now create a new kickstart profile:
     a. In Spacewalk
	1. select Systems|Kickstart|Profiles and then select "+ create new kickstart profile"
	1. Give your new profile a label - in this case "Fedora-9-No-Tools"
	1. Select the base channel you created earlier
	1. Select the kickstartable tree you created earlier
	1. Select the virtualization type you intend the target machine to utilize.
	1. Click "Next", and on the next screen just accept the "Default Download Location" and click "Next"
	1. Give you new machine type a default root password, and then click "Finish"
	1. If you run cobbler profile list you'll now see these entries in addition to those you've already defined:
		*
     a. In Cobbler
 1. Use Spacewalk to kickstart a system with your profiles
 1. Kickstart a bare-metal machine
 1. Kickstart a virtual machine
	a. In Spacewalk
	a. With koan

== Cobbler Templating Variables, Kernel Options, and how they can help ==

 * How to add variables to Kickstart Distributions, Profiles and Systems in the Spacewalk GUI
 * How to do the same in Cobbler
 * How to use these variables in a kickstart file

== Upload your own Kickstart File ==

 * Discussion of new 'upload' mode of creating a kickstart profile
 * How this differs from the 'wizard' mode, and cobbler implications
 * Moving from 'wizard' mode to the full templating mode
 * Details where these files are stored on the file system

== How Integration Works ==

 * What happens when you create a Distro in the GUI, outline creation in spacewalk DB and XMLRPC calls into cobbler
 * What happens when you create a Profile in the GUI, outline creation in spacewalk DB and XMLRPC calls into cobbler
 * When and why we create cobbler system records. 
 * What happens when the user creates cobbler objects and when they show up in Spacewalk, and where these operations are limited
 * taskomatic's job in syncing changes from spacewalk to cobbler
 * taskomatic's job in syncing changes from cobbler to cobbler

== Cobbler Tips And Tricks ==

 * Cobbler editing of fields in Spacewalk through the cobbler command line
 * PXE features in more depth
   * PXE boot loop prevention and all about BIOS order
 * Virt features in more depth
 * cobbler power management (integration in a future release?)
 * cobbler dhcp/dns management
 * cobbler replicate and it's use in Spacewalk context
 * other cobbler features you might find interesting


