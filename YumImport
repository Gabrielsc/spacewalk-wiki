= PROTOSPEC DOCUMENT =
=== TOPIC: Import content from a Yum repo ===
=== REQUESTOR: jmrodri ===
=== REVIEWED BY: ===
=== RELEASE: Spacewalk 0.6 ===

== BUSINESS DEFINITION ==
Make it easier to import content into Spacewalk. Today a user must download a repo locally then upload the packages via {{{rhnpush}}}.
See UploadFedoraContent for an explanation of what is involved.

== OTHER FEATURE IMPACT ==
None

== PROPOSED IMPLEMENTATION ==
 * UI
  * Add a URL widget to the Channel Edit page to allow one to define the yum repo.
  * when user hits 'sync', task will be performed asynchronously.  
  * Will only be additive, packages removed from the yum repo, will remain in the channel
 * Yum Repo interaction will use Yum module from jopr
 * Api support for syncing channel, setting repo
 * Schema Changes
  * Add rhnChannelRepo table to store  repo -> channel (many-to-one) mapping

== USE CASES == 

- User wants to sync Fedora repo to a channel
- User has private yum repo and wants to bring that into his spacewalk server

     
== SAMPLE CODE ==
=== Channel creation page ===

Sample image of what kickstart details will look like (minus the 'sync schedule feature')
[[Image(channel-creation.png, 50%)]]

== WORK ITEMS ==

 * Add schema to support associated yum repo(s) with channel (allow future support of multiple repos)
 * Integrate Jopr's yum syncing module in
 * Add UI support for setting yum repo and doing initial sync (asynchronously) 
 * Add UI support for syncing all channels (asynchronously) 
 * New Apis:  (working names)
  * channel.software.repo.set
  * channel.software.repo.sync  


== TEST PLAN ==
Need to test syncing mechanism, as well as the resulting packages and channels to ensure they were created properly



== RISKS/CONCERNS ==
Reading GPG key from package file

== Future Features ==
[wiki:YumImport2 link]

